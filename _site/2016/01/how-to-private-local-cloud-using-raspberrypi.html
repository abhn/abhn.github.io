<!DOCTYPE html>
<html lang="en-us">

<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <link rel="stylesheet" href="/public/css/normalize.css"/>
  <link rel="stylesheet" href="/public/css/bulma.css"/>
  <link rel="stylesheet" href="/public/css/custom.css"/>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">

  <!-- Icons -->
  <link rel="shortcut icon" href="/assets/images/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <title>
    
      Private Local Cloud Storage Using Raspberrypi - How To &middot; Abhishek Nagekar's Blog
    
  </title>

</head>


<body>

<section class="hero is-dark">
  <div class="hero-body">
    <div class="container">
        <h1 class="title">
          <span class="typewrite" data-period="2000" data-type='[ "hello", "namaste", "assalam o alaikum",
          "sat srī akāl", "khammaghani", "hola", "bonjour", "nomoskaar", "guten tag", "kumusta", "salut", "nômoshkar"]'>
            <span class="wrap"></span>
          </span>
        </h1>
      <h4 class="subtitle" id="quote">
      </h4>
    </div>
  </div>
</section>

<div class="main-container">
  <div class="tile is-ancestor is-vertical">


    <nav class="nav has-shadow">

      <div class="nav-left">

        <a href="/" class="nav-item">
          <span class="icon">
            <i class="fa fa-home" aria-hidden="true" title="Homepage"></i>
          </span>
        </a>

        <a href="https://github.com/abhn" class="nav-item">
          <span class="icon">
            <i class="fa fa-github" aria-hidden="true" title="Github"></i>
          </span>
        </a>

        <div class="nav-item" id="searchFieldNav">
          <div class="field has-addons">
            <p class="control">
              <input class="input is-small" type="text" placeholder="Find an article" id="search-text">
            </p>
            <p class="control">
              <a class="button is-dark is-small" onclick="searchHandler();">
                Search
              </a>
            </p>
          </div>
        </div>

      </div>

      <div class="nav-right nav-menu" id='nav-menu'>
        <a href="https://www.nagekar.com/archive" class="nav-item">Archive</a>
        <a href="https://www.nagekar.com/tags" class="nav-item">Tags</a>
      </div>

      <span class="nav-toggle" id="nav-toggle">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
      </span>
    </nav>

    <div class="tile is-parent">
      <div class="tile is-8 is-child main">

        <div class="box">
    <h1 class="post-title">Private Local Cloud Storage Using Raspberrypi - How To</h1>
    <span class="post-meta">11 January, 2016. It was a Monday. <a style="color:grey" href="#disqus_thread"></a></span><hr/>

    <span class="post-text"><p>
	Today we'll see how you can home brew a cloud (in the local sense) storage solution that would be free to use, quite faster than an Internet based one, secure enough from any outside the network intrusion and customizable.
</p>
<p>
	But why do you need to go to such lengths when you can easily create an account on Google and get 15 gigs of free storage. Well, first of all, data that we generate is increasing significantly each day. We have multiple devices with us, most of them with ~16-64 GB storage, which is not at all good enough. Then while our notebooks are getting faster with solid state drives, they are still costly to use for all of our needs like storing tonnes of movies and music videos, that is, if you are still left with space after cramming up your disk with camera pictures. If you opt for a premium account at Dropbox or Google Drive, it will easily cost you ~$100 a year recurring, the cost which can get you a 2 TB WD external hard disk.
</p>
<p>
	Then there is the speed issue. At least here in India, we are deprived Internet connection faster than 2-4 mbps. Most of the times even less than that. Even if we considered the option of backing to an online cloud storage, the bandwidth prevents us from efficiently using what already exists for free. When using an local cloud, the bandwidth is only throttled by your equipments, and most of the times you can easily get ~40-60 mbps, which is fine.
</p>
<p>
	The last issue, depending on how you see it, is the most and the least important. Security. If the files are going to be random movies and music videos, you might not be much worried about some hacker breaking into your cloud storage provider and downloading them, but on the other hand, if the files contain any kind of sensitive personally identifiable information, then you would worry. But having said that, I would always choose a secure storage solution from insecure ones if given an option, even if the data was not at all sensitive.
</p>
<h3>Things you'll need</h3>
<p>
	Now that we've discussed some merits and demerits, lets talk about building the thing. The things you'll need are,
	<ul>
		<li>Raspberry Pi (with all it's setup accessories), with Ethernet port</li>
		<li>Hard disk, any capacity, with SATA to USB converter</li>
		<li>Wireless router</li>
		<li>Ethernet cable or Wifi adapter</li>
		<li>USB power hub [in some cases]</li>
	</ul>
</p>
<h3>Setting up the hardware</h3>
<p>
	<ol>
		<li>Connect the hard disk to the Raspberrypi</li>
		<li>Boot it up and login via ssh</li>
		<li>Run <i>sudo fdisk -l</i> and make sure the hard disk is shown. Note the device name (/dev/sdb or similar)</li>
		<li>If not, try usb power adapter</li>
		<li>If it is showing, we'll have to make sure it mounts to the same location each time we boot up.</li>
		<li>Create a folder for the mount point. I'll be using <pre>/var/www</pre></li>
		<li>It would be advisable to use a separate low privileged user for the process, since we will be changing the user home later on.</li>
		<li><pre>sudo chmod 775 /var/www</pre> and <pre>sudo chown your_username /var/www</pre> to set the permissions for reading, writing and executing.</li>
		<li><pre>sudo blkid</pre> and note the uuid for the external hard disk. Copy it.</li>
		<li>Now we need to make the mounting occur each time we boot the pi up. Open the fstab file by <pre>sudo nano /etc/fstab</pre> and add the following line <pre>UUID="3b28d90f-8805-4ec4-978d-c53ee397a924" /var/www ext4 defaults,errors=remount-ro 0 1</pre> by editing the UUID, mount location and file system and keeping other things constant.</li>
		<li>Reboot the pi, and your /var/www should now be pointing to the external hard disk. If so, you are done with this part of the tutorial. If not, check what did you miss. Also make sure you are able to read and write files to that directory from your user account. If not, recheck the steps, Google for solutions or comment for help.</li>
	</ol>
</p>
<h3>Setting up the FTP server</h3>
<p>
	<ol>
		<li><pre>sudo apt-get install vsftpd</pre> to install the vsFTP server.</li>
		<li>Open the vsftp configuration file by <pre>sudo nano /etc/vsftpd.conf</pre></li>
		<li>
			The would be a lot of options. Just go through and make sure the following lines are there and not commented. If not, add them.
<pre>
	anonymous_enable=NO
	local_enable=YES
	write_enable=YES
	chroot_local_user=YES
	force_dot_files=YES
	local_root=/var/www
	allow_writable_chroot=YES
</pre>
		</li>
		<li>After saving (Ctrl + x and then y) and exiting, restart vsftpd by <pre>sudo service vsftpd restart</pre></li>
		<li>Lastly, change the user home to the FTP root, so that you'll directly get into the FTP server's root on logging into the FTP client. <pre>sudo usermod --home /var/www/ your_username</pre></li>
	</ol>
</p>
<p>
	If all went well, we have a 100% working local cloud storage running off our pi. Now, since not everyone would like to login with terminal each time they wish to access the cloud, I make some customizations to make it easy for even my Mom and Dad to use the cloud.
</p>
<p>
	On the desktop, download and install filezilla. <pre>sudo apt-get install filezilla</pre> should do it on deb derivatives. Create a launcher icon that triggers the command <pre>filezilla sftp://myUsername:myPassword@myIP:myPort/my/root</pre> which in my case became <pre>filezilla sftp://abhishek:password@192.168.1.10:22/var/www</pre>.
</p>
<center><img src="/assets/images/desktop_icon.png" width="800" height="600"/></center>
<center><img src="/assets/images/filezillapi.png" width="800" height="600"/></center>

<p>
	On the mobile phones (we have droids, three of us), I used the 'add ftp server' option in the <a href="https://play.google.com/store/apps/details?id=com.estrongs.android.pop&hl=en" target="_blank">ES File Explorer</a> and created a shortcut on the home screen with the widgets menu. Hence, accessing the cloud was nothing more troublesome than accessing a local folder on the phone.
</p>
<center><img src="/assets/images/es1.png" width="270" height="480"></center>
<center><img src="/assets/images/es2.png" width="270" height="480"></center>
<center><img src="/assets/images/es3.png" width="270" height="480"></center>
<p>
	Now I have my very own, secure, high speed cloud storage solution for all my devices and also for the family. It is really convenient and building a custom case for the thing, it looks pretty badass.
</p>
<center><img src="/assets/images/pisetup.jpg" width="480" height="270"></center>
<p>
	What do you think?
</p></span>
</div>

<div class="box">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-2314128584981990"
         data-ad-slot="1513670662"
         data-ad-format="auto"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>




  <div id="disqus_thread"></div>
<script type="text/javascript">
    
    var disqus_developer = 1;
    var disqus_shortname = 'nagekar'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





      </div>

      <div class="tile is-4 is-child">
        <div class="tile is-parent is-vertical sidebar">

          <div class="tile is-child widget">
            <!--<h2>Related articles</h2>-->

            <div class="card">
              <header class="card-header">
                <p class="card-header-title nice-title">
                  Recent Posts
                </p>
              </header>
              <div class="card-content">
                <div class="content nice-text">
                  <ul>
                  
                  <li><a href="/2017/04/book-review-the-third-wave-steve-case.html">
                    Book Review - The Third Wave By Steve Case
                  </a></li>
                  
                  <li><a href="/2017/02/trip-to-bramhatal-uttarakhand.html">
                    Trek To Bramhatal (Uttarakhand)
                  </a></li>
                  
                  <li><a href="/2017/01/7th-sem-and-then.html">
                    7th Semester And Then
                  </a></li>
                  
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <div class="tile is-child widget">
            <div class="card">
              <header class="card-header">
                <p class="card-header-title nice-title">
                  Recommended Websites
                </p>
              </header>
              <div class="card-content">
                <div class="content nice-text">
                  <ul>
                    <li>
                      <a href="https://xkcd.com">xkcd</a>
                    </li>
                    <li>
                      <a href="http://commitstrip.com">Commit Strip</a>
                    </li>
                    <li>
                      <a href="http://www.smbc-comics.com">SMBC Comics</a>
                    </li>
                    <li>
                      <a href="https://blog.codinghorror.com">Coding Horror</a>
                    </li>
                    <li>
                      <a href="http://waitbutwhy.com">Wait Buy Why</a>
                    </li>
                    <li>
                      <a href="https://simplysoch.wordpress.com/">Simply Soch</a>
                    </li>
					<li>
                      <a href="https://stilldrinking.org/">Still Drinking</a>
                    </li>
                    <li>
                      <a href="https://blog.didierstevens.com//">Didier Stevens</a>
                    </li>
                    <li>
                      <a href="https://www.malwaretech.com/">Malware Tech</a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

        </div>

      </div>

    </div>

  </div>
</div>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <p>
        Some rights reserved.
      </p>
      <p>
        Made with <i class="fa fa-heart"></i> and <a href="https://github.com/jgthms/bulma">Bulma</a>, <a href="https://jekyllrb.com/">Jekyll</a>. Hosted on <a href="https://github.com/">Github</a>
      </p>
      <p>
        <a class="icon" href="https://github.com/abhn">
          <i class="fa fa-github" title="Github"></i>
        </a>
        <a class="icon" href="https://in.linkedin.com/in/AbhishekNagekar">
          <i class="fa fa-linkedin" title="Linkedin"></i>
        </a>
        <a class="icon" href="mailto:abhishek@nagekar.com">
          <i class="fa fa-envelope" title="Email"></i>
        </a>
      </p>
    </div>
  </div>
</footer>

<!-- js -->
<script src="/public/js/custom.js"></script>
<script src="/public/js/typewriter.js"></script>
</body>
</html>
